# ðŸš€ ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ° `test` Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¾Ð¹ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ð¹ Ð¿Ð¾ HTTPS

Ð­Ñ‚Ð¾Ñ‚ Ð¿Ñ€Ð¾ÐµÐºÑ‚ Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÐµÑ‚ **Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³** Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ Ð¸ ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ° Ñ Ð¸Ð¼ÐµÐ½ÐµÐ¼ `test` Ð² Linux-ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ. ÐŸÑ€Ð¸ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¸Ð¸ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ° â€” Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ÑÑ **HTTPS POST-Ð·Ð°Ð¿Ñ€Ð¾Ñ** Ð½Ð° Ð·Ð°Ð´Ð°Ð½Ð½Ñ‹Ð¹ URL Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°. Ð¢Ð°ÐºÐ¶Ðµ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÑŽÑ‚ÑÑ **Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ¸ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ°** Ð¸ **Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒ ÑÐµÑ€Ð²ÐµÑ€Ð° Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°**, Ñ Ð·Ð°Ð¿Ð¸ÑÑŒÑŽ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ Ð² Ñ€Ð°Ð·Ð´ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð»Ð¾Ð³-Ñ„Ð°Ð¹Ð»Ñ‹.

---

## ðŸŽ¯ ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

- âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ñ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ° `test` ÐºÐ°Ð¶Ð´ÑƒÑŽ Ð¼Ð¸Ð½ÑƒÑ‚Ñƒ.
- âœ… ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° **POST-Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð¿Ð¾ HTTPS** Ð½Ð° `https://test.com/monitoring/test/api`, ÐµÑÐ»Ð¸ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½.
- âœ… ÐžÑ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ **Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ PID** â†’ Ñ„Ð¸ÐºÑÐ°Ñ†Ð¸Ñ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ° Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ°.
- âœ… Ð Ð°Ð·Ð´ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð»Ð¾Ð³Ð¸:
  - `/var/log/monitoring_restart.log` â€” Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ¸ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ°.
  - `/var/log/monitoring_error.log` â€” Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°.
- âœ… ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð·Ð°Ð¿ÑƒÑÐº Ñ‡ÐµÑ€ÐµÐ· **systemd timer** (ÐºÐ°Ð¶Ð´ÑƒÑŽ Ð¼Ð¸Ð½ÑƒÑ‚Ñƒ).
- âœ… ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ‡ÐµÑ€ÐµÐ· **Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Nginx Ð² Docker** Ñ ÑÐ°Ð¼Ð¾Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ°Ð½Ð½Ñ‹Ð¼ SSL-ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ð¼.

---

## ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ
â”œâ”€â”€ monitor_test.sh # ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°\
â”œâ”€â”€ monitor-test.service # systemd-ÑÐµÑ€Ð²Ð¸Ñ\
â”œâ”€â”€ monitor-test.timer # systemd-Ñ‚Ð°Ð¹Ð¼ÐµÑ€\
â””â”€â”€ README.md # Ð­Ñ‚Ð¾Ñ‚ Ñ„Ð°Ð¹Ð»


---

## ðŸ›  Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°

### 1. ÐšÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ

```bash
git clone https://github.com/songspeta/monitor-test.git
cd monitor-test 
```
### 2. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°

```bash
sudo cp monitor_test.sh /usr/local/bin/
sudo chmod +x /usr/local/bin/monitor_test.sh
```
### 3. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° systemd
```bash 
sudo cp monitor-test.service /etc/systemd/system/
sudo cp monitor-test.timer /etc/systemd/system/

sudo systemctl daemon-reload
sudo systemctl enable monitor-test.timer
sudo systemctl start monitor-test.timer
```
## ðŸ“Š Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð¿Ð¸ÑˆÐµÑ‚ Ð² Ð´Ð²Ð° Ñ„Ð°Ð¹Ð»Ð°:

- ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ¸ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ°:
```bash 
tail -f /var/log/monitoring_restart.log
```
ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð·Ð°Ð¿Ð¸ÑÐ¸:
```bash
2025-04-16 12:30:00 - ÐŸÑ€Ð¾Ñ†ÐµÑÑ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑ‰ÐµÐ½, PID Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»ÑÑ Ñ 1234 Ð½Ð° 5678
```
- ÐžÑˆÐ¸Ð±ÐºÐ¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ:
```bash
tail -f /var/log/monitoring_error.log
```
ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð·Ð°Ð¿Ð¸ÑÐ¸:
```bash
2025-04-16 12:31:00 - Ð¡ÐµÑ€Ð²ÐµÑ€ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½: https://test.com/monitoring/test/api
```
## ðŸ§ª Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾)
Ð¢Ð°Ðº ÐºÐ°Ðº test.com  Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ Ð´Ð»Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð², Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Nginx Ð² Docker.

### 1. Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ SSL-ÑÐµÑ€Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð°
```bash
openssl req -x509 -nodes -newkey rsa:2048 -keyout /tmp/nginx.key -out /tmp/nginx.crt -days 365 -subj "/C=RU/ST=Moscow/L=Moscow/O=Test/CN=test.com"
```
### 2. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð° Nginx
```bash 
cat > tmp/nginx.conf << 'EOF'
events {
    worker_connections 1024;
}

http {
    server {
        listen 80;
        return 301 https://$server_name$request_uri;
    }

    server {
        listen 443 ssl;
        ssl_certificate /etc/nginx/ssl/nginx.crt;
        ssl_certificate_key /etc/nginx/ssl/nginx.key;

        location /monitoring/test/api {
            return 200 "OK\n";
            add_header Content-Type text/plain;
        }
    }
}
EOF
```
### 3. Ð—Ð°Ð¿ÑƒÑÐº Nginx Ð² Docker
```bash 
docker run -d \
  --name test-monitoring-server \
  -p 443:443 \
  -v /tmp/nginx.conf:/etc/nginx/nginx.conf:ro \
  -v /tmp/nginx.crt:/etc/nginx/ssl/nginx.crt:ro \
  -v /tmp/nginx.key:/etc/nginx/ssl/nginx.key:ro \
  nginx:alpine
  ```
  ### 4. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° DNS
  ```bash 
  echo "127.0.0.1 test.com" | sudo tee -a /etc/hosts
  ```
## ðŸ“ ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ: Ð·Ð°Ñ‡ÐµÐ¼ Ð´Ð²Ð° Ð»Ð¾Ð³-Ñ„Ð°Ð¹Ð»Ð° Ð¸ Ñ€Ð°ÑÑˆÐ¸Ñ€ÑÐµÐ¼Ð¾ÑÑ‚ÑŒ

Ð Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð»Ð¾Ð³Ð¾Ð² Ð½Ð° Ð´Ð²Ð° Ñ„Ð°Ð¹Ð»Ð° Ð´Ð»Ñ ÑƒÐ¿Ñ€Ð¾Ñ‰ÐµÐ½Ð¸Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð¸ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¸:
- monitoring_restart.log ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ° Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ°
- monitoring_error.log Ñ„Ð¸ÐºÑÐ¸Ñ€ÑƒÐµÑ‚ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ñ Ð²Ð½ÐµÑˆÐ½Ð¸Ð¼Ð¸ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÑÐ¼Ð¸

Ð­Ð¢Ðž:

- ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ñ€Ð°Ð·Ð´ÐµÐ»ÑŒÐ½ÑƒÑŽ Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸ÑŽ Ð»Ð¾Ð³Ð¾Ð²
- ÐžÐ±Ð»ÐµÐ³Ñ‡Ð°ÐµÑ‚ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸ÑŽ Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°Ð¼Ð¸ ÑÐ±Ð¾Ñ€Ð° Ð»Ð¾Ð³Ð¾Ð²
- Ð’ Ð±ÑƒÐ´ÑƒÑ‰ÐµÐ¼ Ð² ÑÑ‚Ð¸ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¼Ð¾Ð¶Ð½Ð¾ Ñ€Ð°ÑÑˆÐ¸Ñ€Ð¸Ñ‚ÑŒ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ
